air_humidifier:
  automation:
    - alias: "[Humidifier] Low water level notification"
      initial_state: true
      trigger:
        - platform: numeric_state
          entity_id: sensor.zhimi_ca4_713f_water_level
          below: 40
          id: "40"
        - platform: numeric_state
          entity_id: sensor.zhimi_ca4_713f_water_level
          below: 20
          id: "20"
        - platform: numeric_state
          entity_id: sensor.zhimi_ca4_713f_water_level
          below: 11
          id: "11"
      action:
        - action: notify.send_message
          data:
            entity_id: notify.tg_eliia
            message: |
              ‚ö†Ô∏è **–í —É–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤–æ–¥–∞!**

              –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã: {{ states('sensor.zhimi_ca4_713f_water_level') }}% 
              –í–ª–∞–∂–Ω–æ—Å—Ç—å –≤ –∫–æ–º–Ω–∞—Ç–µ: {{ states('sensor.zhimi_ca4_713f_relative_humidity') }}% üíß

    - alias: "[Humidifier] Water refilled thank you"
      initial_state: true
      trigger:
        - platform: state
          entity_id: sensor.zhimi_ca4_713f_water_level
      condition:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —É—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã –≤—ã—Ä–æ—Å (–Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ–ª—å—à–µ —Å—Ç–∞—Ä–æ–≥–æ)
        - condition: template
          value_template: >
            {% set old = trigger.from_state.state | float(0) %}
            {% set new = trigger.to_state.state | float(0) %}
            {{ new > old + 10 }}
      action:
        - action: notify.send_message
          data:
            entity_id: notify.tg_eliia
            message: |
              ‚úÖ **–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –∑–∞–ª–∏–ª–∏ –≤–æ–¥–∏—á–∫—É!**

              –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã: {{ states('sensor.zhimi_ca4_713f_water_level') }}%
              –¢–µ–ø–µ—Ä—å —É–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—å —Å–Ω–æ–≤–∞ –≤ —Å—Ç—Ä–æ—é.
              –í–ª–∞–∂–Ω–æ—Å—Ç—å –≤ –∫–æ–º–Ω–∞—Ç–µ: {{ states('sensor.zhimi_ca4_713f_relative_humidity') }}% üíß

    - alias: "[Humidifier] Evening status report"
      initial_state: true
      trigger:
        - platform: time
          at: "21:00:00"
      action:
        - action: notify.send_message
          data:
            entity_id: notify.tg_eliia
            message: |
              üåô **–í–µ—á–µ—Ä–Ω–∏–π —Å—Ç–∞—Ç—É—Å —É–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—è**

              –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã: {{ states('sensor.zhimi_ca4_713f_water_level') }}%
              –í–ª–∞–∂–Ω–æ—Å—Ç—å –≤ –∫–æ–º–Ω–∞—Ç–µ: {{ states('sensor.zhimi_ca4_713f_relative_humidity') }}% üíß
              {% if states('sensor.zhimi_ca4_713f_water_level') | float(0) < 50 %}
              –í–æ–¥—ã –º–µ–Ω—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã, –º–æ–∂–Ω–æ –Ω–µ–º–Ω–æ–≥–æ –¥–æ–±–∞–≤–∏—Ç—å, —á—Ç–æ–±—ã —Ö–≤–∞—Ç–∏–ª–æ –Ω–∞ –≤—Å—é –Ω–æ—á—å.
              {% else %}
              –í–æ–¥—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –≤—Å—ë –æ–∫! –°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏! üò¥
              {% endif %}
